<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project activeEnvironment="Default" name="COP" resourceRoot="" soapui-version="5.0.0" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" wadlVersion="http://wadl.dev.java.net/2009/02" name="COP_Requests" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://192.168.100.20:10000/basis</con:endpoint><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:endpoint>http://{ip}:{port}/basis</con:endpoint></con:endpoints><con:resource name="getDepartment" path="/department/get"><con:settings/><con:parameters/><con:method name="Basis" method="GET"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 404 400</con:status><con:params/><con:element xmlns:get="http://192.168.100.20/basis/department/get">get:Fault</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:get="http://192.168.100.20/basis/department/get">get:Response</con:element></con:representation><con:request name="getDepartment" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":1
}</con:request><con:originalUri>http://192.168.100.20/basis/department/get</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="queryDepartment" path="/department/query"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>500 405 400</con:status><con:params/><con:element xmlns:quer="http://192.168.100.20/basis/department/query">quer:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.100.20/basis/department/query">quer:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="queryDepartment" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":13333,
"entId":123
}</con:request><con:originalUri>http://192.168.100.20/basis/department/query</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="queryWithEmp" path="/department/queryWithEmp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/department/queryWithEmp">quer:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/department/queryWithEmp">quer:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="queryWithEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":1,
"entId":123
}</con:request><con:originalUri>http://192.168.12.170/basis/department/queryWithEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="queryWithEmpApp" path="/department/queryWithEmpApp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/department/queryWithEmpApp">quer:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/department/queryWithEmpApp">quer:Fault</con:element></con:representation><con:request name="queryWithEmpApp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":111,
"entId":123
}</con:request><con:originalUri>http://192.168.12.170/basis/department/queryWithEmpApp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="departmentGet" path="/department/get"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:get="http://192.168.12.170/basis/department/get">get:Response</con:element></con:representation><con:request name="departmentGet" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":1
}</con:request><con:originalUri>http://192.168.12.170/basis/department/get</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method><con:method name="Method 2" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:get="http://192.168.12.170/basis/department/get">get:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:get="http://192.168.12.170/basis/department/get">get:Fault</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":1
}</con:request><con:originalUri>http://192.168.12.170/basis/department/get</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="departmentAdd" path="/department/add"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.100.20/basis/department/add">add:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/department/add">add:Fault</con:element></con:representation><con:request name="departmentAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"name":"测试222",
"parentId":0,
"entId":123,
"cpsFlag":1
}</con:request><con:originalUri>http://192.168.100.20/basis/department/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="departmentDelete" path="/department/delete"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/department/add">add:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/department/delete">del:Fault</con:element></con:representation><con:request name="departmentDelete" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":5,
"cpsFlag":1
}</con:request><con:originalUri>http://192.168.12.170/basis/department/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="departmentUpdate" path="/department/update"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:upd="http://192.168.12.170/basis/department/update">upd:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:upd="http://192.168.12.170/basis/department/update">upd:Fault</con:element></con:representation><con:request name="departmentUpdate" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":13,
"name":"123123123",
"cpsFlag":1111
}</con:request><con:originalUri>http://192.168.12.170/basis/department/update</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="queryEmp" path="/department/queryEmp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.100.20/basis/department/queryEmp">quer:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:quer="http://192.168.100.20/basis/department/queryEmp">quer:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="queryEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":99
}</con:request><con:originalUri>http://192.168.100.20/basis/department/queryEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="addEmp" path="/department/addEmp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/department/addEmp">add:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/department/addEmp">add:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="addEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":2,
"empIds":[1],
"cpsFlag":1
}</con:request><con:originalUri>http://192.168.12.170/basis/department/addEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="delEmp" path="/department/delEmp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/department/delEmp">del:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/department/delEmp">del:Fault</con:element></con:representation><con:request name="delEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":11,
"empIds":[2],
"cpsFlag":1
}</con:request><con:originalUri>http://192.168.12.170/basis/department/delEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="departmentTop" path="/department/top/{depId}"><con:settings/><con:parameters><con:parameter><con:name>depId</con:name><con:value>123</con:value><con:style>TEMPLATE</con:style><con:default>123</con:default></con:parameter></con:parameters><con:method name="Basis" method="GET"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 404 500</con:status><con:params/><con:element xmlns:top="http://192.168.12.170/basis/department/top">top:Fault</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:top="http://192.168.12.170/basis/department/top">top:Response</con:element></con:representation><con:request name="departmentTop" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":123
}</con:request><con:originalUri>http://192.168.12.170/basis/department/top</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder><con:entry>depId</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="empTop" path="/department/empTop/{depId}/{empId}"><con:settings/><con:parameters><con:parameter><con:name>depId</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter><con:parameter><con:name>empId</con:name><con:value>2</con:value><con:style>TEMPLATE</con:style><con:default>2</con:default></con:parameter></con:parameters><con:method name="Basis" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:ns="http://192.168.12.170/basis/department/empTop/1/2">ns:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>404 500</con:status><con:params/></con:representation><con:request name="empTop" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":123,
"empId":123
}</con:request><con:originalUri>http://192.168.12.170/basis/department/empTop/1/2</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="empId" value="null"/>
  <con:entry key="depId" value="null"/>
</con:parameters><con:parameterOrder><con:entry>depId</con:entry><con:entry>empId</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="employeeGet" path="/employee/get"><con:settings/><con:parameters/><con:method name="Basis" method="GET"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>404</con:status><con:params/><con:element xmlns:get="http://192.168.100.20/basis/employee/get">get:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="employeeGet" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request/><con:originalUri>http://192.168.100.20/basis/employee/get</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="employeeQuery" path="/employee/query"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.100.20/basis/employee/query">quer:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/employee/query">quer:Fault</con:element></con:representation><con:request name="employeeQuery" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"currPage":2,
"recNumPerPage":10,
"name":null,
"mdn":null,
"entId":123,
"userId":1211
}</con:request><con:originalUri>http://192.168.100.20/basis/employee/query</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="employeeAdd" path="/employee/add"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.100.20/basis/employee/add">add:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:add="http://192.168.100.20/basis/employee/add">add:Fault</con:element></con:representation><con:request name="employeeAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"mdn":"17745678901",
"entId":123,
"depId":1,
"name":"177sss",
"gender":1,
"remark":"一个专家"
}</con:request><con:originalUri>http://192.168.100.20/basis/employee/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="employeeDelete" path="/employee/delete"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/employee/delete">del:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/employee/delete">del:Fault</con:element></con:representation><con:request name="employeeDelete" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"empId":1
}</con:request><con:originalUri>http://192.168.12.170/basis/employee/delete</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="employeeUpdate" path="/employee/update"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:upd="http://192.168.12.170/basis/employee/update">upd:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:upd="http://192.168.12.170/basis/employee/update">upd:Fault</con:element></con:representation><con:request name="employeeUpdate" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{"empId":23,"name":"zhangsan","gender":1,"remark":"备注而已!@#$%^&amp;**()）备注而已"}</con:request><con:originalUri>http://192.168.12.170/basis/employee/update</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="addRole" path="/employee/addRole"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>500 405</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/employee/addRole">add:Fault</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/employee/addRole">add:Response</con:element></con:representation><con:request name="addRole" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{"empId":1,"roleIds":[21]}</con:request><con:originalUri>http://192.168.12.170/basis/employee/addRole</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="delRole" path="/employee/delRole"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>500 405</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/employee/delRole">del:Fault</con:element></con:representation><con:request name="delRole" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{"empId":1,"roleIds":[21]}</con:request><con:originalUri>http://192.168.12.170/basis/employee/delRole</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionAddEmp" path="/attention/addEmp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/attention/addEmp">add:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/attention/addEmp">add:Fault</con:element></con:representation><con:request name="attentionAddEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":-123,
"empIds":[-116]
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/addEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionDelEmp" path="/attention/delEmp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/attention/delEmp">del:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/attention/delEmp">del:Fault</con:element></con:representation><con:request name="attentionDelEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":1123,
"empIds":[1001,1101,1012]
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/delEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionQueryEmp" path="/attention/queryEmp"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/attention/queryEmp">quer:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/attention/queryEmp">quer:Fault</con:element></con:representation><con:request name="attentionQueryEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":128
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/queryEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionAddDep" path="/attention/addDep"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/attention/addDep">add:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/attention/addDep">add:Fault</con:element></con:representation><con:request name="attentionAddDep" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depIds":[1,2,3],
"userId":1
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/addDep</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionDelDep" path="/attention/delDep"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/attention/delDep">del:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/attention/delDep">del:Fault</con:element></con:representation><con:request name="attentionDelDep" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depIds":[2,3],
"userId":1
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/delDep</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionQueryDep" path="/attention/queryDep"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/attention/queryDep">quer:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/attention/queryDep">quer:Fault</con:element></con:representation><con:request name="attentionQueryDep" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":2
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/queryDep</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionAddAddr" path="/attention/addAddr"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/attention/addAddr">add:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/attention/addAddr">add:Fault</con:element></con:representation><con:request name="attentionAddAddr" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"tableId":-120,
"dataIds":[-1,-2,-3],
"userId":-3
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/addAddr</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionDelAddr" path="/attention/delAddr"><con:settings/><con:parameters/><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/attention/delAddr">del:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:del="http://192.168.12.170/basis/attention/delAddr">del:Fault</con:element></con:representation><con:request name="attentionDelAddr" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"tableId":120,
"dataIds":[100,101,102],
"userId":1
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/delAddr</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="attentionQueryAddr" path="/attention/queryAddr/"><con:settings/><con:parameters><con:parameter><con:name>userId</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Basis" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/attention/queryAddr">quer:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>404 405 400</con:status><con:params/><con:element xmlns:quer="http://192.168.12.170/basis/attention/queryAddr">quer:Fault</con:element></con:representation><con:request name="attentionQueryAddr" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":1234
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/queryAddr</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="userId" value="123" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>userId</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="roleAdd" path="/role/add"><con:settings/><con:parameters/><con:method name="Method 1" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10001</con:endpoint><con:request>{"name":"entrole","entId":1314 ,"descr":"角色描述","menuList":[{"menuId":123, "menuName":"name"}],"modelList":[{"modelId":23,"modelName":"tianyiduijiang"}]}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="noticeAdd（load）" path="/notice/add"><con:settings/><con:parameters/><con:method name="Method 1" method="GET"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{"name":"entrole","entId":1314 ,"descr":"角色描述","menuList":[{"menuId":123, "menuName":"name"}],"modelList":[{"modelId":23,"modelName":"tianyiduijiang"}]}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="noticeAdd" path="/notice/add"><con:settings/><con:parameters/><con:method name="Method 1" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request><![CDATA[{
"userId":1,
"entId":123,
"notice":{
		"title":"新版本发布啦2",
		"content":"<html><body><p>新版本发布啦！</p></body></html>",
		"attachmentUrls":["http://www.baidu.com"]
		}
}]]></con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request><con:request name="Copy of noticeAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request><![CDATA[{
"userId":1,
"entId":123,
"notice":{
		"title":"新版本发布啦",
		"content":"<html><body><p>新版本发布啦！</p></body></html>",
		"attachmentUrls":["http://www.baidu.com"]
		}
}]]></con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method><con:method name="noticeAdd2" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400</con:status><con:params/><con:element xmlns:add="http://192.168.100.20/basis/notice/add">add:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.100.20/basis/notice/add">add:Response</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
    "userId":9999999991,
    "entId": 2,
    "notice": {
        "title": "放假通知",
        "content": "1111",
        "coverPicUrl":"http: //XXXX"
    }
}
</con:request><con:originalUri>http://192.168.100.20/basis/notice/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="noticeQueryList（load）" path="/notice/queryList"><con:settings/><con:parameters/><con:method name="Method 1" method="GET"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400 404</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeQueryList" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="noticeQuery" path="/notice/query"><con:settings/><con:parameters/><con:method name="Method 1" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400 404</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="noticeQuery" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"entId":123,
"startDate":"",
"endDate":"",
"currPage":1,
"recNumPerPage":20
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="noticeQueryApp" path="/notice/queryApp/{entId}/{noticeId}"><con:settings/><con:parameters><con:parameter><con:name>entId</con:name><con:value>123</con:value><con:style>TEMPLATE</con:style><con:default>123</con:default></con:parameter><con:parameter><con:name>noticeId</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Method 1" method="GET"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400 404 500</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeQueryApp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"noticeId":1,
"entId":123
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="noticeId" value=""/>
  <con:entry key="entId" value="222"/>
</con:parameters><con:parameterOrder><con:entry>entId</con:entry><con:entry>noticeId</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="noticeGet(load)" path="/notice/get"><con:settings/><con:parameters/><con:method name="Method 1" method="GET"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400 404</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeGet" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource><con:resource name="noticeGet" path="/notice/get/{noticeId}"><con:settings/><con:parameters><con:parameter><con:name>noticeId</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Method 1" method="GET"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400 404 500</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeGet" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder><con:entry>noticeId</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="noticegetApp" path="/notice/getApp/{noticeId}"><con:settings/><con:parameters><con:parameter><con:name>noticeId</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Method 1" method="GET"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400 404 500</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeGetApp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="noticeId" value="5" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>noticeId</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="noticeTop" path="/notice/top"><con:settings/><con:parameters><con:parameter><con:name>noticeId</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Method 1" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>405 400 404</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:add="http://192.168.12.170/basis/role/add">add:Response</con:element></con:representation><con:request name="noticeTop" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":1,
"entId":123,
"noticeId": 1,
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="noticeId" value="2" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>noticeId</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite name="Test"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="getDepartment" searchProperties="true" id="2dd82453-40a2-4919-af6d-98f18a2d070e"><con:settings/><con:testStep type="restrequest" name="getDepartment"><con:settings/><con:config service="COP_Requests" resourcePath="/department/get" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="getDepartment" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request/><con:originalUri>http://192.168.12.170/basis/department/get</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}


def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps["${testcase.name}"].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = "00000"
//def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=1;
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="departmentQuery" searchProperties="true" id="b70fdb92-ab09-4aae-bb71-ca31bd85a1ad"><con:settings/><con:testStep type="datasource" name="DataSource" id="8a3ce352-2128-4354-b8e1-df7da4ee4ee5"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">asdfadf</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abeddd</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">12312312399</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">!2#@#</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">nobody</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>entId</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="departmentQuery"><con:settings/><con:config service="COP_Requests" resourcePath="/department/query" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="departmentQuery" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId},
"entId":${DataSource#entId}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/query</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" id="b50db9f8-9da6-4592-9166-fc83ea535e61" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["querydep"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="de8ca11d-1ec0-4339-a48d-487a4649dabd"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>departmentQuery</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>b50db9f8-9da6-4592-9166-fc83ea535e61</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>de8ca11d-1ec0-4339-a48d-487a4649dabd</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="queryWithEmp" searchProperties="true" id="f479243d-df75-42a5-9f99-37886fcf9f58"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">asdfadf</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abeddd</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1231231231231231231111111111111111111111111111111111111111111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1231231231231231231111111111111111111111111111111111111111111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">!2#@#</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>entId</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="queryWithEmp"><con:settings/><con:config service="COP_Requests" resourcePath="/department/queryWithEmp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="queryWithEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId},
"entId":${DataSource#entId}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/queryWithEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder><con:entry>ip</con:entry><con:entry>port</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["queryWithEmp"].getTestRequest().getResponseContentAsXml()
def dataSource=testRunner.testCase.testSteps['DataSource']
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="ad657192-1cda-4f51-8473-c81421100ee4"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>queryWithEmp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>5f371d3e-2460-48d5-8324-5960501cd395</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="queryWithEmpApp" searchProperties="true" id="5d330b10-5655-4d9d-9489-8dfd1bd71bb6"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">asdfadf</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abeddd</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1231231231231231231111111111111111111111111111111111111111111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1231231231231231231111111111111111111111111111111111111111111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">!2#@#</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>entId</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="queryWithEmpApp"><con:settings/><con:config service="COP_Requests" resourcePath="/department/queryWithEmpApp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="queryWithEmpApp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId},
"entId":${DataSource#entId}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/queryWithEmpApp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder><con:entry>ip</con:entry><con:entry>port</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["queryWithEmpApp"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}
</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="5f371d3e-2460-48d5-8324-5960501cd395"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>queryWithEmpApp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ad657192-1cda-4f51-8473-c81421100ee4</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="departmentGet" searchProperties="true" id="9cb05a38-9239-4a4a-97f3-dec131e4b68b"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">asdfadf</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1234599999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">￥%……%@#</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1234</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="departmentGet" id="b06a66bb-8491-4c2f-813f-e9156fb300d2"><con:settings/><con:config service="COP_Requests" resourcePath="/department/get" methodName="Method 2" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="departmentGet" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":${DataSource#depId}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/get</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["departmentGet"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-departmentGet-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="e7a82b6a-5058-42d6-ab7a-974669ac8368"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>departmentGet</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>b06a66bb-8491-4c2f-813f-e9156fb300d2</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e7a82b6a-5058-42d6-ab7a-974669ac8368</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="departmentAdd" searchProperties="true" id="ca632a83-1716-4c0b-a656-cd48f3eb5d42"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加2</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加4</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加5</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加6</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加7777777777777777777777777777777777777777777777777777777777777777777777777777777777</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">99999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加12￥%……&amp;%*&amp;&amp;*$^@</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00011</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加13</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00012</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加14</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00103</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">测试部门添加1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00102</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>name</con:property><con:property>parentId</con:property><con:property>entId</con:property><con:property>cpsFlag</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="departmentAdd"><con:settings/><con:config service="COP_Requests" resourcePath="/department/add" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="departmentAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"name":"${DataSource#name}",
"parentId":${DataSource#parentId},
"entId":${DataSource#entId},
"cpsFlag":${DataSource#cpsFlag}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["departmentAdd"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-departmentAdd-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="b4bf4329-f558-4ca8-8a9e-12720031742b"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>departmentAdd</targetStep></con:config></con:testStep><con:setupScript>import groovy.sql.Sql;
try{
	def DBProperties = testRunner.testCase.getTestSuite();
	def sql = Sql.newInstance(DBProperties.getPropertyValue("DB_Connection_URL"),DBProperties.getPropertyValue( "DB_loginname"),DBProperties.getPropertyValue( "DB_Password"),DBProperties.getPropertyValue( "DB_Driver_Class"));
	def deldep = sql.rows("delete from public.group where name like '测试部门添加%'")
}catch(Exception e){
	e.printStackTrace();
}
finally{
	try{ sql.close();}catch(Exception e){log.info(e);log.info("finally");}
}</con:setupScript><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>b4bf4329-f558-4ca8-8a9e-12720031742b</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="departmentDelete" searchProperties="true" id="4b8d093c-c6c6-45cc-923f-b42d8c93eef9"><con:settings/><con:testStep type="datasource" name="DataSource" id="a8e8c822-41e2-4cdd-9525-5d6afe11d961"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">99999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">77777777777777777777</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">add</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depId</con:property><con:property>cpsFlag</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="departmentDelete"><con:settings/><con:config service="COP_Requests" resourcePath="/department/delete" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="departmentDelete" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":${DataSource#depId},
"cpsFlag":${DataSource#cpsFlag}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/delete</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["departmentDelete"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-departmentDelete-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="91174224-fea3-4c95-b33d-0bd6a7aab87b"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>departmentDelete</targetStep></con:config></con:testStep><con:setupScript>import groovy.sql.Sql;
try{
	def DBProperties = testRunner.testCase.getTestSuite();
	def sql = Sql.newInstance(DBProperties.getPropertyValue("DB_Connection_URL"),DBProperties.getPropertyValue("DB_loginname"),DBProperties.getPropertyValue("DB_Password"),DBProperties.getPropertyValue("DB_Driver_Class"));
	def updatedel = sql.rows("update public.group set status = '0' where id = '7'")
}catch(Exception e){
	e.printStackTrace();
}
finally{
	try{ sql.close();log.info("close");}catch(Exception e){log.info("Final:"+e);}
}</con:setupScript><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>a8e8c822-41e2-4cdd-9525-5d6afe11d961</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>91174224-fea3-4c95-b33d-0bd6a7aab87b</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="departmentUpdate" searchProperties="true" id="4c3a4efa-59e9-4230-8596-0ace9a5403df"><con:settings/><con:testStep type="datasource" name="DataSource" id="080b4610-abf9-439e-9eae-c44ee02c148f"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部7777</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部4</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部5</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部6</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部7777777777777777777777777777777777777777777777777777777777777777777777777777777777</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">99999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部12￥%……&amp;%*&amp;&amp;*$^@</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部13</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部14</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部14</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部14</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">998</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">depId不存在</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">政企部14</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">776</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00012</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">没事干的</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00102</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">未命名</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>name</con:property><con:property>parentId</con:property><con:property>cpsFlag</con:property><con:property>depId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="departmentUpdate"><con:settings/><con:config service="COP_Requests" resourcePath="/department/update" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="departmentUpdate" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":${DataSource#depId},
"name":"${DataSource#name}",
"parentId":${DataSource#parentId},
"cpsFlag":${DataSource#cpsFlag}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/update</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["departmentUpdate"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-departmentUpdate-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="470b5967-de03-462d-bb94-b25f162cebff"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>departmentUpdate</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>080b4610-abf9-439e-9eae-c44ee02c148f</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>470b5967-de03-462d-bb94-b25f162cebff</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="queryEmp" searchProperties="true" id="108fc06d-4b94-4181-86c3-d51a6b63581d"><con:settings/><con:testStep type="datasource" name="DataSource" id="b26fca49-c5cd-46f1-89cb-95dea9db9ea3"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">2</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00013</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">775</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00013</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%^</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="queryEmp"><con:settings/><con:config service="COP_Requests" resourcePath="/department/queryEmp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="queryEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":${DataSource#depId}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/queryEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["queryEmp"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-queryEmp-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="bb120d04-6adc-4637-95e2-4511a79a880d"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>queryEmp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>b26fca49-c5cd-46f1-89cb-95dea9db9ea3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>bb120d04-6adc-4637-95e2-4511a79a880d</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="addEmp" searchProperties="true" id="eaf8a32f-681b-4b80-ba63-0144ee1c5e68"><con:settings/><con:testStep type="datasource" name="DataSource" id="ce5a919c-dd39-4ad2-94c2-52f4aa20f5c3"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9,10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9,10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9,10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9,10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8,9,10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9,10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aaaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">99999999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[11]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[999999999999999]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[12]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1111111111111111111111111111111111111111111111111111111111111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[13]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[-8,-9,-10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[14]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[0]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">993</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9,10,11,12,13,14,15,16,17]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00013</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[15]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[15]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[#$%^&amp;]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[16]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%^</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depId</con:property><con:property>empIds</con:property><con:property>cpsFlag</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="addEmp"><con:settings/><con:config service="COP_Requests" resourcePath="/department/addEmp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="addEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":${DataSource#depId},
"empIds":${DataSource#empIds},
"cpsFlag":${DataSource#cpsFlag}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/addEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["addEmp"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-addEmp-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="e1878e45-f1b0-4ffe-8616-b19affeb8b87"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>addEmp</targetStep></con:config></con:testStep><con:setupScript>import groovy.sql.Sql;
try{
	def DBProperties = testRunner.testCase.getTestSuite();
	def sql = Sql.newInstance(DBProperties.getPropertyValue("DB_Connection_URL"),DBProperties.getPropertyValue("DB_loginname"),DBProperties.getPropertyValue("DB_Password"),DBProperties.getPropertyValue("DB_Driver_Class"));
	def updatedel = sql.rows("delete from public.r_group_terminal where group_id = '11'")
}catch(Exception e){
	e.printStackTrace();
}
finally{
	try{ sql.close();log.info("close");}catch(Exception e){log.info("Final:"+e);}
}</con:setupScript><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ce5a919c-dd39-4ad2-94c2-52f4aa20f5c3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e1878e45-f1b0-4ffe-8616-b19affeb8b87</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="empTop" searchProperties="true" id="55114df0-c95c-4ad7-aeb3-29c9f5ef62ff"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11111111111111111111111111111111111111111111111111111111111111111111111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">2222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00012</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">772</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$^</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$^</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depId</con:property><con:property>empId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="empTop" id="11c2af2a-9ef5-4481-9c7a-6951e60474ba"><con:settings/><con:config service="COP_Requests" resourcePath="/department/empTop/{depId}/{empId}" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="empTop" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":123,
"empId":123
}</con:request><con:originalUri>http://192.168.12.170/basis/department/empTop/1/2</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="empId" value="${DataSource#empId}"/>
  <con:entry key="depId" value="${DataSource#depId}"/>
</con:parameters><con:parameterOrder><con:entry>depId</con:entry><con:entry>empId</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["empTop"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
def selectedrow=dataSource.toString()
File log = new File("D:\\cop-empTop-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+selectedrow+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="93749999-69c7-49d4-a52b-54ed1b386d40"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>empTop</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ce5a919c-dd39-4ad2-94c2-52f4aa20f5c3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>11c2af2a-9ef5-4481-9c7a-6951e60474ba</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>93749999-69c7-49d4-a52b-54ed1b386d40</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="delEmp" searchProperties="true" id="59edeec6-71e6-4514-a3fb-2002a51dd449"><con:settings/><con:testStep type="datasource" name="DataSource" id="b8ab57ad-6dc0-4d72-a1f6-7eae9a2ddea2"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[13,14]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[15]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[15]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">15,16,17</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[15]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aaaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">99999999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[15]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[999999999999999]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[15]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1111111111111111111111111111111111111111111111111111111111111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,9]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[-8,-9,-10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[10]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">772</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00013</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[11]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[12]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[!@#$%]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depId</con:property><con:property>empIds</con:property><con:property>cpsFlag</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="delEmp"><con:settings/><con:config service="COP_Requests" resourcePath="/department/delEmp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="delEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":${DataSource#depId},
"empIds":${DataSource#empIds},
"cpsFlag":${DataSource#cpsFlag}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/delEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["delEmp"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-delEmp-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="e6bcee1d-295d-428d-b1d5-c627f67e495f"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>delEmp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ce5a919c-dd39-4ad2-94c2-52f4aa20f5c3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>b8ab57ad-6dc0-4d72-a1f6-7eae9a2ddea2</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e6bcee1d-295d-428d-b1d5-c627f67e495f</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="departmentTop" searchProperties="true" id="9ccd3202-fee7-4a7b-b30a-abd5611387ba"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">4</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row>&lt;xml-fragment>&lt;con:entry xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry xmlns:con="http://eviware.com/soapui/config">00008&lt;/con:entry>&lt;/xml-fragment></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">666666666666666666666666666666666666666666666666666666666666666666666666666666666</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">994</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00013</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">666!@#$</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="departmentTop"><con:settings/><con:config service="COP_Requests" resourcePath="/department/top/{depId}" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="departmentTop" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depId":${DataSource#depId}
}</con:request><con:originalUri>http://192.168.12.170/basis/department/top/123</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="depId" value="${DataSource#depId}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>depId</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststeps name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["departmentTop"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-departmentTop-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="be0ea6f6-a713-43de-bdd7-3ae248e06cf0"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>departmentTop</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>b26fca49-c5cd-46f1-89cb-95dea9db9ea3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>be0ea6f6-a713-43de-bdd7-3ae248e06cf0</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="employeeGet" searchProperties="true" id="607dff14-770d-4a3e-a329-45230c0665fa"><con:settings/><con:testStep type="restrequest" name="employeeGet"><con:settings/><con:config service="COP_Requests" resourcePath="/employee/get" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="employeeGet" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request/><con:originalUri>http://192.168.12.170/basis/employee/get</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}


def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps["${testcase.name}"].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = "00000"
//def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=1;
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="employeeQuery" searchProperties="true" id="aef279a3-8935-45b8-a543-4e972f729724"><con:settings/><con:testStep type="datasource" name="DataSource" id="6723ac76-2e2c-467e-b7b0-cf1e758fa9d8"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10aaaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">呵呵</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123aadsa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">asdf</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">100</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">99999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1391160</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111999999999999999999999999999999999999999999777777777777777777777777777777777777777777777777799999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一22#412%*&amp;*</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-18011111111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">老一</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">13911604453</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>currPage</con:property><con:property>recNumPerPage</con:property><con:property>name</con:property><con:property>mdn</con:property><con:property>entId</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="employeeQuery"><con:settings/><con:config service="COP_Requests" resourcePath="/employee/query" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="employeeQuery" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"currPage":${DataSource#currPage},
"recNumPerPage":${DataSource#recNumPerPage},
"name":${DataSource#name},
"mdn":${DataSource#mdn},
"entId":${DataSource#entId},
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/employee/query</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["employeeQuery"].getTestRequest().getResponseContentAsXml()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-employeeQuery-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="e92eecc2-5d72-4e16-b45b-8e02ddbec92a"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>employeeQuery</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>6723ac76-2e2c-467e-b7b0-cf1e758fa9d8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e92eecc2-5d72-4e16-b45b-8e02ddbec92a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="employeeAdd" searchProperties="true" disabled="true"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000000</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row>&lt;xml-fragment/></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000001</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000002</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000003</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000004</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000005</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abskldfjl</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000006</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aklds</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000007</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1ad</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000008</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试&amp;(&amp;*(&amp;*(</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000009</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000010</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家syof卡；&amp;*（&amp;*&amp;</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000011181000000111810000001118100000011</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000011</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1231234567890123456789012345678901234</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000012</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1231234567890123456789012345678901234</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000013</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试1231234567890123456789012345678901234 </con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000014</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1231234567890123456789012345678901234</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000015</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家1231234567890123456789012345678901234 </con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-18100000016</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000017</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000018</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000019</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000020</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">18100000000</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试2</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">一个专家2</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>mdn</con:property><con:property>entId</con:property><con:property>depId</con:property><con:property>name</con:property><con:property>gender</con:property><con:property>remark</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="employeeAdd"><con:settings/><con:config service="COP_Requests" resourcePath="/employee/add" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="employeeAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"mdn":${DataSource#mdn},
"entId":${DataSource#entId},
"depId":${DataSource#depId},
"name":${DataSource#name},
"gender":${DataSource#gender},
"remark":"${DataSource#remark"
}</con:request><con:originalUri>http://192.168.12.170/basis/employee/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["employeeAdd"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-employeeAdd-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="560d5930-5dce-417a-ac3f-79f13964fd9c"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>employeeAdd</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>6723ac76-2e2c-467e-b7b0-cf1e758fa9d8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>560d5930-5dce-417a-ac3f-79f13964fd9c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="employeeDelete" searchProperties="true" id="22facf40-53aa-4608-a069-9969ebcd65c4" disabled="true"><con:settings/><con:testStep type="datasource" name="DataSource" id="1dd6df88-0eff-4bf3-a72c-8b8b27e9e5a1"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">21</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row>&lt;con:entry xmlns:con="http://eviware.com/soapui/config">0&lt;/con:entry></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-21</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9195</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>empId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="employeeDelete"><con:settings/><con:config service="COP_Requests" resourcePath="/employee/delete" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="employeeDelete" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"empId":${DataSource#empId}
}</con:request><con:originalUri>http://192.168.12.170/basis/employee/delete</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["employeeDelete"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-employeeDelete-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="e884d0c3-d8c9-4839-9a05-8a820091847d"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>employeeDelete</targetStep></con:config></con:testStep><con:setupScript>import groovy.sql.Sql;
try{
	def DBProperties = testRunner.testCase.getTestSuite();
	def sql = Sql.newInstance(DBProperties.getPropertyValue("DB_Connection_URL"),DBProperties.getPropertyValue("DB_loginname"),DBProperties.getPropertyValue("DB_Password"),DBProperties.getPropertyValue("DB_Driver_Class"));
	def updatedel = sql.rows("update public.employee set status = '0' where id = '21'")
}catch(Exception e){
	e.printStackTrace();
}
finally{
	try{ sql.close();log.info("close");}catch(Exception e){log.info("Final:"+e);}
}</con:setupScript><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>1dd6df88-0eff-4bf3-a72c-8b8b27e9e5a1</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e884d0c3-d8c9-4839-9a05-8a820091847d</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="employeeUpdate" searchProperties="true" id="653c0df0-a275-4e84-b1c7-141a4369d43c"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">修改员工</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">阿飞</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备22222啊手机的疯狂啦就流口水的饭卡里说；发卡量十分艰苦拉萨空间里的风景啊看来士大夫艰苦拉萨角度考虑发神经开绿灯飞机啊就考了多少分就拉开士大夫艰苦了注而已呵呵呵呵呵呵哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备22222啊</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">2212312312312312312312322222222222222222222222222222222222222222222222222222222222222222222222222222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222啊手机的疯狂啦就流口水的饭卡里说；发卡量十分艰苦拉萨空间里的风景啊看来士大夫艰苦拉萨角度考虑发神经开绿灯飞机啊就考了多少分就拉开士大夫艰苦了</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">99</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">哈哈哈哈哈哈哈</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222啊看来对方！@#￥%……&amp;*（）)(*&amp;^%$#</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">备注而已!@#$%^&amp;**()）备注而已</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00011</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">待修改</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">阿飞</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>empId</con:property><con:property>name</con:property><con:property>gender</con:property><con:property>remark</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="employeeUpdate"><con:settings/><con:config service="COP_Requests" resourcePath="/employee/update" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="employeeUpdate" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"empId":${DataSource#empId},
"name":${DataSource#name},
"gender":${DataSource#gender},
"remark":"${DataSource#remark}"
}
</con:request><con:originalUri>http://192.168.12.170/basis/employee/update</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["employeeUpdate"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-employeeUpdate-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="5a50d959-b2ec-4a73-9175-84376fba7e2d"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>employeeUpdate</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>6723ac76-2e2c-467e-b7b0-cf1e758fa9d8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>5a50d959-b2ec-4a73-9175-84376fba7e2d</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="addRole" searchProperties="true" id="d8344856-c63e-4a34-828a-a8fe2b4589b7" disabled="true"><con:settings/><con:testStep type="datasource" name="DataSource" id="610f1732-3fa1-4ea1-8263-eaa3dbed18a3"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">100</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>empId</con:property><con:property>roleIds</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="addRole"><con:settings/><con:config service="COP_Requests" resourcePath="/employee/addRole" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="addRole" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://{ip}:{port}/basis</con:endpoint><con:request>{"empId":${DataSource#empId},"roleIds":${DataSource#roleIds}}</con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>addRole</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>610f1732-3fa1-4ea1-8263-eaa3dbed18a3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="delRole" searchProperties="true" disabled="true" id="3820939e-c535-4109-892a-800e19242362"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">100</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>empId</con:property><con:property>roleIds</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="delRole"><con:settings/><con:config service="COP_Requests" resourcePath="/employee/delRole" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="delRole" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://{ip}:{port}/basis</con:endpoint><con:request>{"empId":${DataSource#empId},"roleIds":${DataSource#roleIds}}</con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>delRole</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>610f1732-3fa1-4ea1-8263-eaa3dbed18a3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionAddEmp" searchProperties="true" id="07b216df-f9c4-4a02-98d2-f32214470988"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[7,8]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[4]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[883]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[400]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[a,b,c]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[7]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">已关注</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[401]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[-402]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%^&amp;*()</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[404]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[405,"%&amp;^^*&amp;"]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>userId</con:property><con:property>empIds</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionAddEmp"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/addEmp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionAddEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId},
"empIds":${DataSource#empIds}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/addEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["attentionAddEmp"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-attentionAddEmp-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="1aefb8e5-1ae3-48e5-bcdb-119187e9362e"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionAddEmp</targetStep></con:config></con:testStep><con:setupScript>import groovy.sql.Sql;
try{
	def DBProperties = testRunner.testCase.getTestSuite();
	def sql = Sql.newInstance(DBProperties.getPropertyValue("DB_Connection_URL"),DBProperties.getPropertyValue("DB_loginname"),DBProperties.getPropertyValue("DB_Password"),DBProperties.getPropertyValue("DB_Driver_Class"));
	def delattention = sql.rows("delete from public.attention_emp where followed_user_id = '123' or followed_user_id = '-123'")
}catch(Exception e){
	e.printStackTrace();
}
finally{
	try{ sql.close();log.info("close");}catch(Exception e){log.info("Final:"+e);}
}</con:setupScript><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ecfb5be4-b002-4944-b0a9-f8cd0ae290c8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f345a284-e9e2-4444-9035-25028ef67b34</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>37ce3724-6d28-442d-b1a4-deb09ab53172</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>ffe854cd-39ed-4908-986f-59286cd01c71</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>1aefb8e5-1ae3-48e5-bcdb-119187e9362e</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionDelEmp" searchProperties="true" id="d8c9d126-37c1-42a7-93ba-531d0f16a41e"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[7,8]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[4]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999999999999999999999999999999999999999999999999999999999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[3334]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00001</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[400]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[a,b,c]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[401]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[401]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[-402]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%^&amp;*()</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[404]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[405,"%&amp;^^*&amp;"]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>userId</con:property><con:property>empIds</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionDelEmp"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/delEmp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionDelEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId},
"empIds":${DataSource#empIds}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/delEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["attentionDelEmp"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-attentionDelEmp-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="3bc3c190-9993-439f-ad29-738f2a0482f5"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionDelEmp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ecfb5be4-b002-4944-b0a9-f8cd0ae290c8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>3bc3c190-9993-439f-ad29-738f2a0482f5</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionQueryEmp" searchProperties="true" id="323fcd9a-5e02-4aa9-8cbf-a055d23e858c"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-1234</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">"a@#$%^&amp;*()"</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionQueryEmp"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/queryEmp" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionQueryEmp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/queryEmp</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["attentionQueryEmp"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-attentionQueryEmp-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="d0aece82-e370-4289-bde0-65cdb1ba9990"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionQueryEmp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ecfb5be4-b002-4944-b0a9-f8cd0ae290c8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>21960282-da4a-492c-8129-70f201580ddb</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d0aece82-e370-4289-bde0-65cdb1ba9990</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionAddDep" searchProperties="true" id="5c36ca53-a0fd-431f-91d5-ef379d5a3899"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[123456789012345678901234567890991]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[7]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">4321</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[-4]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[4]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[@#$,%^&amp;,*(0]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[4]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%^</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[6643]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00013</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depIds</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionAddDep" id="dc50942f-07c8-4854-8f87-049b680ea2b9"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/addDep" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionAddDep" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depIds":${DataSource#depIds},
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/addDep</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="2f998704-67db-4db7-b674-d83d6278a2c4"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionAddDep</targetStep></con:config></con:testStep><con:setupScript>import groovy.sql.Sql;
try{
	def DBProperties = testRunner.testCase.getTestSuite();
	def sql = Sql.newInstance(DBProperties.getPropertyValue("DB_Connection_URL"),DBProperties.getPropertyValue("DB_loginname"),DBProperties.getPropertyValue("DB_Password"),DBProperties.getPropertyValue("DB_Driver_Class"));
	def delattention = sql.rows("delete from public.attention_dep where followed_user_id = '123' or followed_user_id = '-123' or followed_user_id = '4321'")
}catch(Exception e){
	e.printStackTrace();
}
finally{
	try{ sql.close();log.info("close");}catch(Exception e){log.info("Final:"+e);}
}</con:setupScript><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ecfb5be4-b002-4944-b0a9-f8cd0ae290c8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>2f998704-67db-4db7-b674-d83d6278a2c4</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>dc50942f-07c8-4854-8f87-049b680ea2b9</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionDelDep" searchProperties="true" id="ee4cbc87-aa1d-4d81-9ed2-b194a9913b6c"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[123456789012345678901234567890991]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00013</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[7]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">4444</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">userId不存在</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[-4]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[8]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[@#$,%^&amp;,*(0]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">[99]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">!@#$%^</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>depIds</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionDelDep"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/delDep" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionDelDep" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"depIds":${DataSource#depIds},
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/delDep</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="e52aa17b-44a5-4cf8-9e30-bb40ed7e6819"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionDelDep</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>ecfb5be4-b002-4944-b0a9-f8cd0ae290c8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e52aa17b-44a5-4cf8-9e30-bb40ed7e6819</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionQueryDep" searchProperties="true" id="0620aee2-86a6-4164-8005-369488218188"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">12345</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">0</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">$%$^%</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionQueryDep"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/queryDep" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionQueryDep" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/queryDep</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionQueryDep</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>f6dbce14-c873-4ded-811e-416890864d88</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionAddAddr" searchProperties="true" id="1e36ea5e-d3c2-4ef0-8c40-b9b076919d72"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">121</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">122</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[123456789012345678901234567890991]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">124</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">125</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[bc]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">126</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">重复</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">128</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[-1,-2]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">129</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">*^&amp;*</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[7]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">130</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,*(&amp;*(&amp;]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">131</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[9]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">*&amp;*(*&amp;(@!#</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>tableId</con:property><con:property>dataIds</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionAddAddr"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/addAddr" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionAddAddr" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"tableId":${DataSource#tableId},
"dataIds":${DataSource#dataIds},
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/addAddr</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionAddAddr</targetStep></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" disabled="true"><con:settings/><con:config><script>def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
log.info(code)</script></con:config></con:testStep><con:setupScript>import groovy.sql.Sql;
try{
	def DBProperties = testRunner.testCase.getTestSuite();
	def sql = Sql.newInstance(DBProperties.getPropertyValue("DB_Connection_URL"),DBProperties.getPropertyValue("DB_loginname"),DBProperties.getPropertyValue("DB_Password"),DBProperties.getPropertyValue("DB_Driver_Class"));
	def delattention = sql.rows("delete from public.attention_addr where followed_user_id = '123' or followed_user_id = '-123'")
}catch(Exception e){
	e.printStackTrace();
}
finally{
	try{ sql.close();log.info("close");}catch(Exception e){log.info("Final:"+e);}
}</con:setupScript><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>607e8bfb-b84e-4c15-aa6f-bb8f8581a6b3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionDelAddr" searchProperties="true" id="41be44d3-2371-4aaa-a96e-b66bba2f4043"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[123456789012345678901234567890991]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2,3,4,5]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[bc]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1200</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">tableId 不存在</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">userId不存在</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">不存在</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[1,2]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">128</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[-1]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[6]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">*^&amp;*</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[7]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[8,*(&amp;*(&amp;]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[9]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">*&amp;*(*&amp;(@!#</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">120</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">[22,23]</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">dataId不存在</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>tableId</con:property><con:property>dataId</con:property><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionDelAddr"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/delAddr" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionDelAddr" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"tableId":${DataSource#tableId},
"dataIds":${DataSource#dataId},
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/delAddr</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionDelAddr</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>607e8bfb-b84e-4c15-aa6f-bb8f8581a6b3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="attentionQueryAddr" searchProperties="true" id="14fd2cd8-e524-47bc-a083-d625e8938fda"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">null</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123456789012345678901234567890991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">2222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00200</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00006</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">^&amp;*^@#&amp;*$!@</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>userId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="attentionQueryAddr"><con:settings/><con:config service="COP_Requests" resourcePath="/attention/queryAddr/" methodName="Basis" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="attentionQueryAddr" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000/basis</con:endpoint><con:request>{
"userId":${DataSource#userId}
}</con:request><con:originalUri>http://192.168.12.170/basis/attention/queryAddr/</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder><con:entry>userId</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>attentionQueryAddr</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>607e8bfb-b84e-4c15-aa6f-bb8f8581a6b3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeAdd(load)" searchProperties="true" id="ad324624-6e0c-4a8d-9fd5-0a8cb8632541"><con:settings/><con:testStep type="restrequest" name="noticeAdd(load)"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/add" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeAdd(load)" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{"name":"entrole","entId":1314 ,"descr":"角色描述","menuList":[{"menuId":123, "menuName":"name"}],"modelList":[{"modelId":23,"modelName":"tianyiduijiang"}]}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}


def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps["${testcase.name}"].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = "00000"
//def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=1;
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeAdd" searchProperties="true" id="b440509a-601a-47e0-a346-df5be5d60ab5"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试1测试1测试1测试1测试1测试1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">"http: //XXXX","”http: //XXXX2"</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">http://www.baidu.com/pic.png</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试2</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">侧室2222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">测试3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试3</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">333</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">测试4</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">4444</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试5</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">5555</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试6</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试6</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试7</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">7777</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">llla</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试8</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">8888</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9999999990</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试9</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9999999990</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">101010</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">test11</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试12</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试12</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1212</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">8888</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试13</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试13</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1313</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">userId\entId不存在</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">8888</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试13</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">测试13</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1313</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">userId\entId不存在</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>userId</con:property><con:property>entId</con:property><con:property>notice.title</con:property><con:property>notice.content</con:property><con:property>notice.attachmentUrls</con:property><con:property>notice.coverPicUrl</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="noticeAdd"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/add" methodName="noticeAdd2" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeAdd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request><![CDATA[{
"userId":${DataSource#userId},
"entId":${DataSource#entId},
"notice":{
		"title":"${DataSource#notice.title}",
		"content":"<html><body><p>${DataSource#notice.content}</p></body></html>",
		"coverPicUrl":"${DataSource#notice.coverPicUrl}"
		}
}]]></con:request><con:originalUri>http://192.168.100.20/basis/notice/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testSuites=testRunner.testCase.getTestSuite();
def testcase = testRunner.testCase;
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-noticeAdd-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output" id="fed7ddd4-a476-4bd6-95e2-fd841fd911b4"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>noticeAdd</targetStep></con:config></con:testStep><con:properties><con:property><con:name>date</con:name><con:value>2017-02-22</con:value></con:property><con:property><con:name>LogFile - Check Response</con:name><con:value>d:\SoapUI_log\2017-02-22\Test - noticeAdd - Wed Feb 22 15-27-39 CST 2017.log</con:value></con:property><con:property><con:name>LogFile - Response Detail</con:name><con:value>d:\SoapUI_log\2017-02-22\Test - noticeAdd - Wed Feb 22 15-27-39 CST 2017 Response Detail.log</con:value></con:property></con:properties><con:reportParameters/><con:breakPoints><con:testStepId>3baa336b-00b1-4839-9001-40744b9d68e7</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>84b68ee4-6c9f-4150-8abc-3c8171a91c38</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>16ae4d48-315c-4c70-af92-3491d1311995</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>fed7ddd4-a476-4bd6-95e2-fd841fd911b4</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeQueryList(load)" searchProperties="true" id="43d899f0-5f19-4dad-91c4-0e1375890cef"><con:settings/><con:testStep type="restrequest" name="noticeQueryList(load)"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/queryList" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeQueryList(load)" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output" id="bc1e8489-c868-4fcf-9d6d-4771aa272eeb"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}


def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps["${testcase.name}"].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = "00000"
//def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=1;
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeQuery" searchProperties="true" id="170b2f4e-bd9b-40c6-9172-b2a2502fea67"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">233</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">新</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">20</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">新</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00802</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">新</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00802</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">新</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">新</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">新</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9999999991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">abc</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">233</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">22222222</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2222222333</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00802</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">bbbb</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00802</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">a</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">b</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2017-10-10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">2016-02-22</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">10</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00801</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>entId</con:property><con:property>startDate</con:property><con:property>endDate</con:property><con:property>title</con:property><con:property>currPage</con:property><con:property>recNumPerPage</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="noticeQuery"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/query" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeQuery" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"entId":${DataSource#entId},
"startDate":"${DataSource#startDate}",
"endDate":"${DataSource#endDate}",
"title":"${DataSource#title}",
"currPage":${DataSource#currPage},
"recNumPerPage":${DataSource#recNumPerPage}
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["noticeQuery"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-noticeQuery-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output" id="28dd80f6-6b1c-4fe0-890b-9bbf980863c3"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>noticeQuery</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>b27d4956-aa1c-4216-ac9d-402359a59035</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>2576824f-e94f-43ff-8cb3-a4e3852b6950</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>28dd80f6-6b1c-4fe0-890b-9bbf980863c3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeQueryApp" searchProperties="true" id="52805c8d-fe95-4701-b737-c50349ce011c"><con:settings/><con:testStep type="datasource" name="DataSource" id="3e9d0314-3835-453c-b307-b6e67a3ce754"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">20</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00008</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config"/><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">20</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">9999999999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">-123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">-99</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00009</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">34534</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">entId不存在</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">123</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">999</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">noticeId不存在</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>entId</con:property><con:property>noticeId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="noticeQueryApp"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/queryApp/{entId}/{noticeId}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeQueryApp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"noticeId":1,
"entId":123
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="noticeId" value="${DataSource#noticeId}"/>
  <con:entry key="entId" value="${DataSource#entId}"/>
</con:parameters><con:parameterOrder><con:entry>entId</con:entry><con:entry>noticeId</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>noticeQueryApp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeGet(load)" searchProperties="true" id="4db00223-d017-4868-bca2-cc72a05d9510"><con:settings/><con:testStep type="restrequest" name="noticeGet(load)"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/get" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeGet(load)" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}


def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps["${testcase.name}"].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = "00000"
//def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=1;
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>8f9bc1c9-e0cb-474a-88e9-2e2fc1924ada</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeGet" searchProperties="true" id="bd8436cf-b830-4e9d-93e1-78c3314a1769"><con:settings/><con:testStep type="datasource" name="DataSource"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row>&lt;xml-fragment>&lt;con:entry xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry xmlns:con="http://eviware.com/soapui/config">00010&lt;/con:entry>&lt;/xml-fragment></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9999999991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1111</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">不存在</con:entry></xml-fragment>]]></row></con:configuration></con:dataSource><con:property>noticeId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="noticeGet"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/get/{noticeId}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeGet" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="noticeId" value="${DataSource#noticeId}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>noticeId</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["noticeGet"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-noticeGet-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="f8dceb74-42a0-4304-a629-27b8d3fd2f2d"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>noticeGet</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>b36e25c9-40d1-49fc-90b0-0e78e08126b9</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e6e07c8f-84e4-4395-879a-2de0d16bd3e1</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f8dceb74-42a0-4304-a629-27b8d3fd2f2d</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>bc1e8489-c868-4fcf-9d6d-4771aa272eeb</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="noticeGetApp" searchProperties="true" id="0fd34c00-60e2-4574-bbc3-83e248785ad8"><con:settings/><con:testStep type="datasource" name="DataSource" id="815adb25-a816-4d6b-8cb6-3b42535adcf3"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Grid"><con:configuration><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">1</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00000</con:entry></xml-fragment>]]></row><row>&lt;xml-fragment>&lt;con:entry xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry xmlns:con="http://eviware.com/soapui/config">00010&lt;/con:entry>&lt;/xml-fragment></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">9999999991</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row><![CDATA[<xml-fragment><con:entry xmlns:con="http://eviware.com/soapui/config">aaa</con:entry><con:entry xmlns:con="http://eviware.com/soapui/config">00010</con:entry></xml-fragment>]]></row><row>&lt;xml-fragment>&lt;con:entry xmlns:con="http://eviware.com/soapui/config">1111&lt;/con:entry>&lt;con:entry xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></row></con:configuration></con:dataSource><con:property>noticeId</con:property><con:property>expectedcode</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="restrequest" name="noticeGetApp"><con:settings/><con:config service="COP_Requests" resourcePath="/notice/getApp/{noticeId}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="noticeGetApp" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://192.168.12.170:10000</con:endpoint><con:request>{
"userId":nt,
"entId":nt,
"notice": sting,
"title":string,
"content":string,
"attachmentUrls":sting
}</con:request><con:originalUri>http://192.168.12.170/basis/role/add</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="noticeId" value="${DataSource#noticeId}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>noticeId</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="result" disabled="true"><con:settings/><con:config><script>//save result to d:\\cop-log.txt
//need to change teststep's name
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def wsdlResponse=testRunner.testCase.testSteps["noticeGetApp"].getTestRequest().getResponseContentAsString()
//com.eviware.soapui.impl.wsdl.teststeps.WsdlDataSourceTestStep
def dataSource=testRunner.testCase.testSteps['DataSource']
def row=dataSource.getCurrentRow()
File log = new File("D:\\cop-noticeGetApp-log.txt")
log.withWriterAppend( 'GB2312' ){ w->
def line = context.expand( '${DataSource#line}' )
   w&lt;&lt;"****************************Line:"+row+"****************************"+'\n'+wsdlResponse+'\n'
}</script></con:config></con:testStep><con:testStep type="groovy" name="output" id="e5b8d2a6-2ef7-4567-b6f6-ca83bb4eb683"><con:settings/><con:config><script>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		if(content=="Pass"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.GREEN);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else if(content=="Fail"){
			def wc = new jxl.write.WritableCellFormat();
			wc.setBackground(jxl.format.Colour.RED);
			ws.addCell(new jxl.write.Label(column,row,content,wc));
		}else{
		ws.addCell(new jxl.write.Label(column,row,content));
		}
}

def writeFlag(flagFileName){
	def flagFile = new File(flagFileName);
	if(flagFile.exists()){
		def flag = Integer.parseInt(flagFile.getText());
		flag++;
		flagFile.write("${flag}");
	}
}

def filterCode(wsdlstring){
	def strlen = wsdlstring.length();
	for(def i = 0;i &lt; strlen-12;i++){
		if(wsdlstring[i..i+3] == "code"){
			code = wsdlstring[i+7..i+11]
			break
		}else{
			code = "Error"
		}
	}
}

def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def flag = flagFile.getText();
log.info(flag)
def xlsName = context.expand('${#TestSuite#ExcelReport}');
SheetName = "Result";
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
//获取上下文对象,转化成groovyUtils对象
def testcase = testRunner.testCase;
def wsdlResponse=testRunner.testCase.testSteps[testcase.name].getTestRequest().getResponseContentAsString()
filterCode(wsdlResponse);
def expectedcode = context.expand( '${DataSource#expectedcode}' )
def dataSource=testRunner.testCase.testSteps['DataSource']
def datarow=dataSource.getCurrentRow()
startrow=Integer.parseInt(flag);
try{
Workbook workbook=Workbook.getWorkbook(new File(xlsName));
writableWorkbook =  Workbook.createWorkbook(new File(xlsName), workbook);
updateOutput(writableWorkbook,SheetName,0,startrow,testcase.name+"-"+datarow);
updateOutput(writableWorkbook,SheetName,5,startrow,wsdlResponse);
updateOutput(writableWorkbook,SheetName,2,startrow,code);
updateOutput(writableWorkbook,SheetName,3,startrow,expectedcode);
if(expectedcode==code){
	updateOutput(writableWorkbook,SheetName,4,startrow,"Pass");
}else{
	updateOutput(writableWorkbook,SheetName,4,startrow,"Fail");
}
writeFlag(flagFileName);
writableWorkbook.write();
writableWorkbook.close();
}catch (Exception e){      
	e.printStackTrace();
	log.info(e)
}
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="bfa2099c-6be5-4af1-80a5-4c3d54a539de"><con:settings/><con:config><dataSourceStep>DataSource</dataSourceStep><targetStep>noticeGetApp</targetStep></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>42cf6f1c-36e3-4813-a7a4-cb9663432d78</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>a33c873f-894e-4a90-9419-af411be5a77c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>815adb25-a816-4d6b-8cb6-3b42535adcf3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>bfa2099c-6be5-4af1-80a5-4c3d54a539de</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e5b8d2a6-2ef7-4567-b6f6-ca83bb4eb683</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>3e9d0314-3835-453c-b307-b6e67a3ce754</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties><con:property><con:name>LogFolder</con:name><con:value>d:\SoapUI_log\</con:value></con:property><con:property><con:name>ExcelReport</con:name><con:value>d:\SoapUI_log\COP-Report.xls</con:value></con:property><con:property><con:name>DB_Connection_URL</con:name><con:value>jdbc:postgresql://192.168.12.172:5433/cop_main_test</con:value></con:property><con:property><con:name>DB_loginname</con:name><con:value>postgres</con:value></con:property><con:property><con:name>DB_Password</con:name><con:value>postgres</con:value></con:property><con:property><con:name>DB_Driver_Class</con:name><con:value>org.postgresql.Driver</con:value></con:property></con:properties><con:setupScript>import java.io.*;
import jxl.*;
import jxl.write.*;
import java.util.*;

def updateOutput(writableWorkbook,sheetName,column,row,content){
		Sheet[] sheet= writableWorkbook.getSheets();
		ws = writableWorkbook.getSheet(sheetName);
		if(ws==null){
		ws = writableWorkbook.createSheet(sheetName,sheet.length)
		}
		ws.addCell(new jxl.write.Label(column,row,content));
}

def logFolder = new File(context.expand('${#TestSuite#LogFolder}'));
def flagFileName = (context.expand('${#TestSuite#LogFolder}')+"flag.txt");
def flagFile = new File(flagFileName);
def excelName = (context.expand('${#TestSuite#ExcelReport}'));
def worksheet = "Result";

WritableWorkbook workbook;
try{
	workbook = Workbook.createWorkbook(new File(excelName));
	WritableSheet sheet = workbook.createSheet(worksheet, 0);
	updateOutput(workbook,worksheet,0,0,"Case ID");
	updateOutput(workbook,worksheet,1,0,"Description");
	updateOutput(workbook,worksheet,2,0,"Response Code");
	updateOutput(workbook,worksheet,3,0,"Expected Code");
	updateOutput(workbook,worksheet,4,0,"Result");
	updateOutput(workbook,worksheet,5,0,"Response Details");
	workbook.write();
	workbook.close();
}catch(Exception e){
	e.printStackTrace();
	log.info(e);
}
if(!logFolder.exists()){
	logFolder.mkdirs();
	}
if(!flagFile.exists()){
	flagFile.createNewFile();
	flagFile.write("1");
}
flagFile.write("1");</con:setupScript><con:reportParameters/></con:testSuite><con:requirements/><con:properties/><con:wssContainer/><con:databaseConnectionContainer><con:databaseConnection><con:name>1</con:name><con:driver>org.postgresql.Driver</con:driver><con:connectionString>jdbc:postgresql://192.168.12.172:5433/cop_main_test?user=postgres&amp;password=PASS_VALUE</con:connectionString><con:password>postgres</con:password></con:databaseConnection></con:databaseConnectionContainer><con:oAuth2ProfileContainer/><con:reporting><con:xmlTemplates/><con:parameters/></con:reporting><con:sensitiveInformation/></con:soapui-project>